import Preview from '../../components/preview'
import { Callout } from 'nextra-theme-docs'

<img src="/images/disc.png" style={{width: "100%", marginTop: '20px;'}} />

# Make Multiplayer Games for Discord Activities
<Callout emoji="ðŸ‘·ðŸ¼â€â™€ï¸">
  Discord mode is in public preview. Please report any issues or feedback to us on our [Discord](https://discord.gg/bKZUax4uWz) server.
</Callout>

Discord has opened up activities for third-party developers - [Learn more: Discord Embedded SDK](https://discord.com/developers/docs/activities/overview)

While the Discord SDK facilitates the integration with Activities, developers are responsible for maintaining their own multiplayer game servers. Additionally, an authentication server is necessary to generate Discord authentication tokens for players.

Playroom provides deep integration to manage this for you and lets you use Playroom's state sync and other features for your games. You can also host your game on Playroom's Hosting; our ultra-fast CDN.

**Why use Playroom instead of Discord SDK directly?**

- âœ… Playroom complements Discord SDK by providing a multiplayer server and state sync
- âœ… Playroom handles Room and Player management for you
- âœ… Playroom handles user authentication for you, you get user's Discord profile directly without doing OAuth dance


## Setting up

For this integration to work, you need to connect your Playroom game to your Discord application.

- To start, create a game project on [Playroom Dev Portal](https://dev.joinplayroom.com)
- Click on **Discord** tab and follow the instructions to connect your Discord application.
- In your game, add `gameId` and `discord` fields to your `insertCoin` call like this:
```js
import { insertCoin, getState, setState, onPlayerJoin } from 'playroomkit'
// Show popup and ask user permissions for their discord information
await insertCoin({
  gameId: "<id from playroom portal>",
  discord: true
});

// Print current player's server name and avatar url
console.log(me().getProfile())

// Players of this activity session are now in same room now! Set shared state
setState("topScore", 42)

// Called for each player joining the same activity session
onPlayerJoin((playerState)=>{
  // Print player's server name and avatar url
  console.log(playerState.getProfile()) // {name: "username", photo: "https://cdn.discord...."}
})

// On some other player
const topScore = getState("topScore")
```

- You can open your game in browser to test it out. Playroom will mock the Discord auth and user profile for you.
- When ready, run your game inside Discord. See [how to load my activity into Discord](https://discord.com/developers/docs/activities/building-an-activity#step-4-running-your-app-locally-in-discord).

<Callout type="info" emoji="ðŸ’¡">
Check out the [Making a Multiplayer Game](/multiplayer) to learn how Playroom works or try enabling discord on any of the [Templates](/templates).
</Callout>


### Inviting Other Players

You can show Discord invite dialog from your game by calling `openDiscordInviteDialog()` method like this:

```js
import { openDiscordInviteDialog } from 'playroomkit'

// ... after game started

openDiscordInviteDialog()
```

### Calling Other Discord Commands

You can get the Discord client by calling `getDiscordClient()` and then call any of the [SDK Commands](https://discord.com/developers/docs/developer-tools/embedded-app-sdk#sdk-commands) directly. 
